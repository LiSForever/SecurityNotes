### 任意文件上传漏洞审计

#### SpringBoot对于JSP的限制

* JSP可以用作上传JSPShell

* SpringBoot原生不支持JSP，SpringBoot使用JSP需要引入额外的依赖，而且需要自建WEB-INF、web.xml等操作，这会丧失SpringBoot的一些特性

* 通过pom.xml判断是否支持JSP

```xml
<!--用于编译jsp-->
<dependency>
<groupId>org.apache.tomcat.embed</groupId>
<artifactId>tomcat-embed-jasper</artifactId>
<scope>provided</scope>
</dependency>
```

### 文件类型校验

#### 文件后缀名校验

#### 文件后缀校验黑白名单

* 黑名单是否遗漏

* 白名单是否有冷门利用？

#### MIME type检测

#### 后端对于上传文件名的操作

* 直接保存

* 可预测/爆破的随机

* 难以预测/爆破的随机

* 能否从前端获取保存后的文件名

#### 保存路径

* 保存在本地or云端

* 是否解析路径

* 路径是否可控

#### 文件上传功能点定位

关键字搜寻

```textile
File
FileUpload
FileUploadBase
FileItemIteratorImpl
FileItemStreamImpl
FileUtils
UploadHandleServlet
FileLoadServlet
FileOutputStream
DiskFileItemFactory
MultipartRequestEntity
MultipartFile
com.oreilly.servlet.MultipartRequest
```

### JSP木马
